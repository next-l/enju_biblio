<div id="content_detail" class="ui-corner-all ui-widget-content">
<h1 class="ui-widget-header"><%= t('page.listing', model: t('activerecord.models.periodical')) -%></h1>
<div id="content_list">
<p id="notice"><%= notice %></p>

<p><%= @periodicals.total_entries %> <%= t('page.title') %></p>

<div class="search_form">
<%= form_for :periodicals, url: periodicals_path, html: {method: 'get'} do -%>
  <p>
    <%= label_tag :search_form_top, t('page.search_term') -%>:
    <%= search_field_tag 'q', h(@query), {id: 'search_form_top', class: 'search_form', placeholder: t('page.search_term')} -%>
    <%= submit_tag t('page.search') -%>
  </p>
<%- end -%>
</div>

<table class="table table-striped index">
  <thead>
    <tr>
      <th><%= t('activerecord.attributes.periodical.original_title') %></th>
      <th colspan="4"></th>
    </tr>
  </thead>

  <tbody>
    <% @periodicals.each do |periodical| %>
      <tr>
        <td>
          <% if periodical.manifestation %>
            <strong><%= link_to periodical.original_title, periodical.manifestation %></strong>
          <% else %>
            <strong><%= link_to periodical.original_title, periodical %></strong>
            (master not found)
          <% end %>
          <br />
          <% if periodical.manifestation %>
            <%= periodical.manifestation.publishers.pluck(:full_name).join(' ') %>
            <br / >
            ISSN: <%= periodical.manifestation.issn_records.pluck(:body).join(' ') %>
            URL: <%= link_to periodical.manifestation.access_address, periodical.manifestation.access_address if periodical.manifestation.access_address %>
          <% end %>
        </td>
        <td><%= periodical.manifestations.count %></td>
        <td><%= link_to t('page.add'), new_manifestation_path(periodical_id: periodical.id) %></td>
        <td><%= link_to t('page.edit'), edit_periodical_path(periodical) %></td>
        <td><%= link_to t('page.destroy'), periodical, method: :delete, data: { confirm: t('page.are_you_sure') } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= paginate(@periodicals) %>
</div>
</div>

<div id="submenu" class="ui-corner-all ui-widget-content">
  <ul>
    <%- if policy(Periodical).create? -%>
      <li><%= link_to t('page.new', model: t('activerecord.models.periodical')), new_periodical_path -%></li>
    <%- end -%>
  </ul>
</div>
